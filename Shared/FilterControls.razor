@using Microsoft.AspNetCore.Components

<div class="d-flex align-items-center gap-2 mb-3">
    <label class="me-2">Sắp xếp:</label>
    <select class="form-select w-auto" @bind="Selected">
        <option value="default">Mặc định</option>
        <option value="price_asc">Giá: tăng dần</option>
        <option value="price_desc">Giá: giảm dần</option>
    </select>
</div>

@code {
    [Parameter]
    public EventCallback<string> SortChanged { get; set; }

    [Parameter]
    public string InitialSort { get; set; } = "default";

    private string selected = "default";

    // Property được bind; setter sẽ gọi EventCallback khi giá trị thay đổi
    private string Selected
    {
        get => selected;
        set
        {
            if (selected == value) return;
            selected = value;
            // Gọi bất đồng bộ — không await trong setter để tránh deadlock,
            // nhưng vẫn đảm bảo event được phát.
            _ = SortChanged.InvokeAsync(selected);
        }
    }

    protected override void OnInitialized()
    {
        selected = InitialSort ?? "default";
    }
}
